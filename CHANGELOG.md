# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

#### ğŸ› ï¸ RouteProcessor è·¯ç·šåˆ†çµ„è™•ç†å™¨ ğŸ†•
- **æ–°å¢ RouteProcessor é¡åˆ¥** (`src/survey_grouping/processors/route_processor.py`)ï¼š
  - å°ˆé–€è™•ç†è·¯ç·šåˆ†çµ„ Excel æª”æ¡ˆçš„è³‡æ–™è™•ç†å™¨
  - æ”¯æ´å¤šå·¥ä½œè¡¨è·¯ç·šåˆ†çµ„æ ¼å¼ï¼Œæ¯å€‹å·¥ä½œè¡¨ä»£è¡¨ä¸€æ¢è·¯ç·š
  - å‹•æ…‹è·¯ç·šå‘½åï¼šè‡ªå‹•ç”Ÿæˆå¦‚ ç¯¤åŠ 01ã€è¥¿å¯®02 ç­‰è·¯ç·šåç¨±
  - è·¨æ‘é‡Œåœ°å€æª¢æ¸¬ï¼šæ™ºæ…§è­˜åˆ¥ä¸¦éæ¿¾ä¸åŒæ‘é‡Œçš„åœ°å€
  - æ··åˆåœ°å€æ ¼å¼æ”¯æ´ï¼šåŒæ™‚è™•ç†å®Œæ•´åœ°å€å’Œç°¡å–®åœ°å€
  - è³‡æ–™åº«é„°åˆ¥æŸ¥è©¢ï¼šè‡ªå‹•æŸ¥è©¢ç¼ºå°‘é„°åˆ¥è³‡è¨Šçš„åœ°å€
  - å­—ç¬¦ä¸€è‡´æ€§è™•ç†ï¼šè™•ç†å¡©åŸ•/é¹½åŸ•ç­‰å­—ç¬¦è®Šç•°å•é¡Œ
  - å…¨é¢åœ°å€ä¿ç•™ï¼šåŒ…å«æ‰€æœ‰æœ‰æ•ˆåœ°å€ï¼ˆå³ä½¿ç„¡åº§æ¨™åŒ¹é…ï¼‰

#### ğŸ”§ RouteProcessor æ ¸å¿ƒåŠŸèƒ½è©³ç´°
- **Excel æ ¼å¼æ”¯æ´**ï¼š
  - ç¬¬ä¸€å€‹å·¥ä½œè¡¨ã€Œæ ¸å®šåå†Šã€è‡ªå‹•è·³é
  - å…¶ä»–å·¥ä½œè¡¨ä»£è¡¨è·¯ç·šï¼ˆå¦‚ï¼šç¯¤åŠ 1ã€ç¯¤åŠ 2ã€è¥¿å¯®1ã€è¥¿å¯®2ï¼‰
  - æ”¯æ´å‹•æ…‹æ¬„ä½æ•¸é‡ï¼ˆ4æ¬„æˆ–6æ¬„æ ¼å¼ï¼‰
- **åœ°å€è™•ç†é‚è¼¯**ï¼š
  - `_is_target_village_address()`ï¼šç›®æ¨™æ‘é‡Œå®Œæ•´åœ°å€æª¢æ¸¬
  - `_is_simple_village_address()`ï¼šç°¡å–®æ‘é‡Œåœ°å€æª¢æ¸¬ï¼ˆå«è·¨æ‘é‡Œè¡çªè™•ç†ï¼‰
  - `_is_different_village_address()`ï¼šä¸åŒæ‘é‡Œåœ°å€æª¢æ¸¬
  - `_process_target_village_address()`ï¼šç›®æ¨™æ‘é‡Œåœ°å€è™•ç†
  - `_process_simple_village_address()`ï¼šç°¡å–®æ‘é‡Œåœ°å€è™•ç†
- **é—œéµä¿®å¾©**ï¼š
  - ä¿®å¾©ä¸ƒè‚¡é‡Œ/ä¸ƒè‚¡å€åŒåå‰ç¶´å°è‡´çš„åœ°å€èª¤åˆ¤å•é¡Œ
  - æ”¹é€²æ­£å‰‡è¡¨é”å¼ï¼šä½¿ç”¨ `[\u4e00-\u9fff]+é‡Œ` åŒ¹é…ä¸­æ–‡æ‘é‡Œåç¨±
  - è§£æ±º `è‡ºå—å¸‚ä¸ƒè‚¡å€å¡©åŸ•é‡Œ6é„°é¹½åŸ•237è™Ÿä¹‹3` è¢«èª¤èªç‚ºä¸ƒè‚¡é‡Œåœ°å€çš„å•é¡Œ
- **è¼¸å‡ºæª”æ¡ˆ**ï¼š
  - `{å€åŸŸ}{æ‘é‡Œ}å‹•ç·šè™•ç†çµæœ.csv`ï¼šæ‰€æœ‰æœ‰æ•ˆåœ°å€ï¼ˆå«åº§æ¨™å’ŒæœªåŒ¹é…ï¼‰
  - `{å€åŸŸ}{æ‘é‡Œ}å‹•ç·šè™•ç†çµæœ_æœªåŒ¹é…åœ°å€.csv`ï¼šæœªæ‰¾åˆ°åº§æ¨™çš„åœ°å€
  - `{å€åŸŸ}{æ‘é‡Œ}å‹•ç·šè™•ç†çµæœ_ç„¡æ•ˆåœ°å€.csv`ï¼šè·¨æ‘é‡Œæˆ–ç„¡æ•ˆåœ°å€

#### ğŸ§ª RouteProcessor å¯¦éš›æ‡‰ç”¨æˆæœ
- **æˆåŠŸè™•ç†8å€‹æ‘é‡Œ**ï¼šä¸­å¯®é‡Œã€ç‰æˆé‡Œã€æ°¸å‰é‡Œã€å¾Œæ¸¯é‡Œã€ç«¹æ©‹é‡Œã€åä»½é‡Œã€ä¸ƒè‚¡é‡Œã€å¡©åŸ•é‡Œ
- **æ•´é«”åŒ¹é…ç‡**ï¼š93.7% (313/334 ç­†åœ°å€)
- **è·¨æ‘é‡Œåœ°å€æª¢æ¸¬**ï¼šæˆåŠŸè­˜åˆ¥ä¸¦éæ¿¾2ç­†è·¨æ‘é‡Œåœ°å€
- **å­—ç¬¦ä¸€è‡´æ€§è™•ç†**ï¼šæ­£ç¢ºè™•ç†å¡©åŸ•é‡Œï¼ˆå¡©ï¼‰èˆ‡é¹½åŸ•é‡Œï¼ˆé¹½ï¼‰çš„å­—ç¬¦å·®ç•°

#### ğŸ› ï¸ VillageProcessor è³‡æ–™è™•ç†å™¨
- **æ–°å¢ VillageProcessor é¡åˆ¥** (`src/survey_grouping/processors/village_processor.py`)ï¼š
  - é€šç”¨æ‘é‡Œæ•¸æ“šè™•ç†å™¨ï¼Œæ”¯æ´ Excel æ•¸æ“šè½‰æ›ç‚º CSV æ ¼å¼ä¸¦åŒ¹é…åº§æ¨™
  - åœ°å€æ¨™æº–åŒ–å’Œ Supabase åº§æ¨™åŒ¹é…åŠŸèƒ½
  - å®Œæ•´çš„å·¥ä½œæµç¨‹ï¼šExcel â†’ æ¨™æº–åŒ–åœ°å€ â†’ åº§æ¨™æŸ¥è©¢ â†’ CSV è¼¸å‡º
  - æœªåŒ¹é…åœ°å€å ±å‘Šç”Ÿæˆï¼Œæ”¯æ´å¾ŒçºŒæ‰‹å‹•è™•ç†

#### ğŸ” åœ°å€åº§æ¨™æŸ¥è©¢åŠŸèƒ½ ğŸ†•
- **æ–°å¢ `query-coordinates` å‘½ä»¤**ï¼šæ”¯æ´æŸ¥è©¢ç‰¹å®šåœ°å€çš„ç¶“ç·¯åº¦åº§æ¨™
- **å¤šå±¤æŸ¥è©¢ç­–ç•¥**ï¼š
  - ç²¾ç¢ºåŒ¹é…ï¼šå„ªå…ˆä½¿ç”¨å®Œæ•´åœ°å€é€²è¡Œç²¾ç¢ºæŸ¥è©¢
  - æ¨¡ç³Šæœå°‹ï¼šç•¶ç²¾ç¢ºåŒ¹é…å¤±æ•—æ™‚ï¼Œè‡ªå‹•é€²è¡Œæ¨¡ç³ŠåŒ¹é…æœå°‹
  - é„°åˆ¥æŸ¥è©¢ï¼šå¯é¸æ“‡æ€§æŒ‡å®šé„°åˆ¥ï¼Œæä¾›é¡å¤–çš„ä¸Šä¸‹æ–‡è³‡è¨Š
- **æ ¼å¼åŒ–è¼¸å‡º**ï¼š
  - å–®ä¸€çµæœï¼šé¡¯ç¤ºåœ°å€ã€åº§æ¨™ã€é„°åˆ¥ã€è³‡æ–™åº«ID
  - å¤šé‡çµæœï¼šä»¥è¡¨æ ¼å½¢å¼é¡¯ç¤ºæœå°‹çµæœï¼ŒåŒ…å«IDã€åœ°å€ã€é„°åˆ¥ã€ç¶“ç·¯åº¦
  - é™åˆ¶é¡¯ç¤ºï¼šæœå°‹çµæœè¶…é10ç­†æ™‚åƒ…é¡¯ç¤ºå‰10ç­†ï¼Œä¸¦æç¤ºç¸½æ•¸
- **å‘½ä»¤ä½¿ç”¨ç¯„ä¾‹**ï¼š
  ```bash
  # åŸºæœ¬åº§æ¨™æŸ¥è©¢
  uv run survey-grouping query-coordinates ä¸ƒè‚¡å€ é ‚å±±é‡Œ é ‚å±±13è™Ÿ
  
  # æŒ‡å®šé„°åˆ¥é€²è¡ŒæŸ¥è©¢
  uv run survey-grouping query-coordinates ä¸ƒè‚¡å€ é ‚å±±é‡Œ é ‚å±±13è™Ÿ --neighborhood 1
  ```
- **è³‡æ–™åº«æŸ¥è©¢æ–¹æ³•æ“´å……**ï¼š
  - `get_address_by_full_address()` æ–¹æ³•ï¼šç²¾ç¢ºåœ°å€æŸ¥è©¢
  - `search_addresses_by_pattern()` æ–¹æ³•ï¼šæ¨¡ç³Šåœ°å€æœå°‹
  - æ”¯æ´å®Œæ•´çš„ç•°æ­¥æŸ¥è©¢æµç¨‹

#### ğŸ†• CSV è¼¸å…¥åˆ†çµ„åŠŸèƒ½
- **æ–°å¢ `--input-csv` åƒæ•¸**ï¼š`create-groups` å‘½ä»¤ç¾åœ¨æ”¯æ´å¾ CSV æª”æ¡ˆè®€å–åœ°å€è³‡æ–™é€²è¡Œåˆ†çµ„
- **å½ˆæ€§è¼¸å…¥æ¨¡å¼**ï¼š
  - è³‡æ–™åº«æ¨¡å¼ï¼šä½¿ç”¨ `district` å’Œ `village` åƒæ•¸å¾ Supabase è®€å–
  - CSV æ¨¡å¼ï¼šä½¿ç”¨ `--input-csv` åƒæ•¸å¾æœ¬åœ° CSV æª”æ¡ˆè®€å–
- **CSV æ ¼å¼æ”¯æ´**ï¼š
  - å¿…è¦æ¬„ä½ï¼šå®Œæ•´åœ°å€ã€å€åŸŸã€æ‘é‡Œã€é„°åˆ¥ã€ç¶“åº¦ã€ç·¯åº¦
  - è‡ªå‹•å¾ CSV è³‡æ–™æ¨æ–·å€åŸŸå’Œæ‘é‡Œè³‡è¨Š
  - æ”¯æ´ UTF-8 å’Œ UTF-8-BOM ç·¨ç¢¼æ ¼å¼
- **ç„¡è³‡æ–™åº«ä¾è³´**ï¼šCSV æ¨¡å¼ä¸‹ç„¡éœ€é€£æ¥ Supabase è³‡æ–™åº«å³å¯é€²è¡Œåˆ†çµ„

#### ğŸ†• CSV å°å…¥è¦–è¦ºåŒ–åŠŸèƒ½
- **æ–°å¢ `visualize-from-csv` å‘½ä»¤**ï¼šæ”¯æ´å¾æ—¢æœ‰çš„ CSV åˆ†çµ„çµæœç›´æ¥ç”Ÿæˆè¦–è¦ºåŒ–åœ°åœ–
- **å½ˆæ€§ CSV æ ¼å¼æ”¯æ´**ï¼š
  - å¿…è¦æ¬„ä½ï¼šåˆ†çµ„ç·¨è™Ÿã€å®Œæ•´åœ°å€ã€å€åŸŸã€æ‘é‡Œã€é„°åˆ¥ã€ç¶“åº¦ã€ç·¯åº¦
  - Optional æ¬„ä½ï¼šåˆ†çµ„å¤§å°ã€ç›®æ¨™å¤§å°ã€é ä¼°è·é›¢ã€é ä¼°æ™‚é–“ã€åœ°å€IDã€è¨ªå•é †åº
- **æ™ºæ…§è·¯ç·šè™•ç†**ï¼š
  - æœ‰è¨ªå•é †åºæ™‚ï¼šé¡¯ç¤ºè·¯ç·šé€£ç·šã€é †åºç·¨è™Ÿã€æ–¹å‘ç®­é ­
  - ç„¡è¨ªå•é †åºæ™‚ï¼šåƒ…é¡¯ç¤ºåˆ†çµ„æ¨™è¨˜é»ï¼Œä¸é€²è¡Œè·¯ç·šè¨ˆç®—
- **æ ¼å¼é©—è­‰èˆ‡éŒ¯èª¤è™•ç†**ï¼š
  - è‡ªå‹•æª¢æŸ¥ CSV æ ¼å¼å®Œæ•´æ€§
  - æ”¯æ´ UTF-8 BOM ç·¨ç¢¼è™•ç†
  - æä¾›è©³ç´°çš„éŒ¯èª¤è¨Šæ¯å’Œä¿®æ­£å»ºè­°

#### ğŸ”§ æ–°å¢æ¨¡çµ„èˆ‡é¡åˆ¥
- **CSVImporter é¡åˆ¥** (`src/survey_grouping/importers/csv_importer.py`)ï¼š
  - `CSVGroupRow` æ¨¡å‹ï¼šCSV è³‡æ–™åˆ—çš„ Pydantic æ¨¡å‹
  - `read_csv_file()` æ–¹æ³•ï¼šè®€å–å’Œè§£æ CSV æª”æ¡ˆ
  - `validate_csv_format()` æ–¹æ³•ï¼šCSV æ ¼å¼é©—è­‰ï¼ˆæ”¯æ´åœ°å€è³‡æ–™å’Œåˆ†çµ„çµæœå…©ç¨®æ¨¡å¼ï¼‰
  - `import_from_csv()` æ–¹æ³•ï¼šå®Œæ•´çš„ CSV å°å…¥æµç¨‹
  - `import_addresses_from_csv()` æ–¹æ³•ï¼šå¾ CSV è®€å–åœ°å€è³‡æ–™è½‰æ›ç‚º Address ç‰©ä»¶åˆ—è¡¨ ğŸ†•
  - `convert_to_route_groups()` æ–¹æ³•ï¼šè½‰æ›ç‚º RouteGroup ç‰©ä»¶

#### ğŸ—ï¸ VillageProcessor å¤šæ ¼å¼æ”¯æ´æ“´å…… âœ¨
- **æ–°å¢åå†Šæ ¼å¼æ”¯æ´** (`src/survey_grouping/processors/village_processor.py`)ï¼š
  - è‡ªå‹•åµæ¸¬ä¸¦æ”¯æ´ä¸‰ç¨® Excel æ ¼å¼ï¼šå¤šå·¥ä½œè¡¨ã€å–®å·¥ä½œè¡¨ã€åå†Šæ ¼å¼
  - æ–°å¢ `_read_roster_format()` æ–¹æ³•ï¼šè™•ç†åŒ…å«å®Œæ•´åœ°å€çš„åå†Šæ ¼å¼
  - æ–°å¢ `convert_fullwidth_to_halfwidth()` å‡½æ•¸ï¼šå…¨å½¢æ•¸å­—è‡ªå‹•è½‰åŠå½¢ï¼ˆï¼‘ï¼’ï¼“ â†’ 123ï¼‰
  - æ–°å¢ `extract_neighborhood_from_address()` å‡½æ•¸ï¼šå¾å®Œæ•´åœ°å€æå–é„°åˆ¥è³‡è¨Š
  - æ–°å¢ `export_invalid_addresses()` æ–¹æ³•ï¼šå°å‡ºè·¨å€åŸŸåœ°å€å ±å‘Š

#### ğŸ”§ é—œéµåœ°å€æ¨™æº–åŒ–ä¿®å¾© ğŸš¨
- **ä¿®å¾© dash-to-zhi è½‰æ›æ¼æ´** (`_standardize_roster_address()` æ–¹æ³•)ï¼š
  - **ä¿®å¾©å‰**ï¼šåå†Šæ ¼å¼ä¸­çš„ "74-1è™Ÿ" æœªè¢«æ¨™æº–åŒ–ï¼Œé€ æˆåŒ¹é…å¤±æ•—
  - **ä¿®å¾©å¾Œ**ï¼šæ­£ç¢ºè½‰æ› "74-1è™Ÿ" â†’ "74è™Ÿä¹‹1"ï¼ŒåŒ¹é…ç‡å¾ 90.6% æå‡è‡³ 96.9%
  - åœ¨ `_standardize_roster_address()` ä¸­æ·»åŠ å° `standardize_village_address()` çš„èª¿ç”¨
  - ç¢ºä¿ dash-to-zhi è½‰æ›é‚è¼¯åœ¨æ‰€æœ‰æ ¼å¼ä¸­éƒ½èƒ½æ­£ç¢ºåŸ·è¡Œ

#### ğŸ” è·¨å€åŸŸåœ°å€è™•ç†å¼·åŒ–
- **æ™ºæ…§åœ°å€éæ¿¾** (`_read_roster_format()` æ–¹æ³•)ï¼š
  - è‡ªå‹•è­˜åˆ¥éç›®æ¨™å€åŸŸå’Œæ‘é‡Œçš„åœ°å€
  - å°‡è·¨å€åŸŸåœ°å€è¨˜éŒ„åˆ° `invalid_addresses` åˆ—è¡¨
  - ç”Ÿæˆå°ˆé–€çš„ç„¡æ•ˆåœ°å€å ±å‘Šï¼Œä¾¿æ–¼å¾ŒçºŒæ‰‹å‹•è™•ç†
  - æä¾›è©³ç´°çš„å•é¡ŒåŸå› èªªæ˜ï¼ˆå¦‚ï¼š"éä¸ƒè‚¡å€ä¸ƒè‚¡é‡Œåœ°å€"ï¼‰

#### ğŸŒ VillageProcessor è·¨æ‘é‡Œè™•ç†åŠŸèƒ½ ğŸ†•
- **æ–°å¢ `--include-cross-village` åƒæ•¸**ï¼š
  - æ”¯æ´åŒå€å…¶ä»–æ‘é‡Œåœ°å€çš„åº§æ¨™åŒ¹é…å’Œè™•ç†
  - ç¶­æŒå‘å¾Œç›¸å®¹æ€§ï¼šé è¨­ç‚ºå–®æ‘é‡Œåš´æ ¼æ¨¡å¼
  - æ–°å¢ `include_cross_village` åˆå§‹åŒ–åƒæ•¸åˆ° VillageProcessor é¡åˆ¥
- **é›™æ¨¡å¼è™•ç†æ¶æ§‹**ï¼š
  - **å–®æ‘é‡Œæ¨¡å¼ï¼ˆé è¨­ï¼‰**ï¼šåªè™•ç†ç›®æ¨™æ‘é‡Œåœ°å€ï¼Œè·¨æ‘é‡Œåœ°å€æ­¸é¡ç‚ºç„¡æ•ˆåœ°å€
  - **è·¨æ‘é‡Œæ¨¡å¼**ï¼šè™•ç†ç›®æ¨™æ‘é‡Œ + åŒå€å…¶ä»–æ‘é‡Œåœ°å€ï¼Œå„è‡ªåŒ¹é…å°æ‡‰åº§æ¨™
- **æ–°å¢æ–¹æ³•æ“´å……**ï¼š
  - `_standardize_cross_village_address()` æ–¹æ³•ï¼šè·¨æ‘é‡Œåœ°å€æ¨™æº–åŒ–é‚è¼¯
  - `_extract_village_name()` æ–¹æ³•ï¼šå¾å®Œæ•´åœ°å€ä¸­æå–æ‘é‡Œåç¨±
  - `export_cross_village_addresses()` æ–¹æ³•ï¼šå°å‡ºè·¨æ‘é‡Œåœ°å€ CSV å ±å‘Š
  - `query_address_coordinates()` æ–°å¢ `target_village` åƒæ•¸ï¼šæ”¯æ´æŒ‡å®šæ‘é‡ŒæŸ¥è©¢
- **è™•ç†é‚è¼¯æ”¹é€²**ï¼š
  - è·¨æ‘é‡Œåœ°å€è‡ªå‹•æå–æ‘é‡Œåç¨±ç”¨æ–¼ç²¾ç¢ºåº§æ¨™æŸ¥è©¢
  - ä¿®æ”¹ `process_data()` å›å‚³å€¼ï¼š`(processed_data, unmatched, cross_village)` 
  - åœ¨ `_read_roster_format()` ä¸­åˆ†é›¢è·¨æ‘é‡Œåœ°å€åˆ°ç¨ç«‹è³‡æ–™çµæ§‹
- **è¼¸å‡ºæª”æ¡ˆæ“´å……**ï¼š
  - æ–°å¢ `{å€åŸŸ}{æ‘é‡Œ}åˆ†çµ„çµæœ_è·¨æ‘é‡Œåœ°å€.csv` å ±å‘Šæª”æ¡ˆ
  - è·¨æ‘é‡Œåœ°å€åŒ…å«ï¼šåºè™Ÿã€å§“åã€å®Œæ•´åœ°å€ã€å€åŸŸã€æ‘é‡Œã€é„°åˆ¥ã€ç¶“ç·¯åº¦
  - CLI è‡ªå‹•ç”Ÿæˆè·¨æ‘é‡Œåœ°å€å ±å‘Šï¼ˆç•¶æœ‰è³‡æ–™ä¸”å•Ÿç”¨è·¨æ‘é‡Œæ¨¡å¼æ™‚ï¼‰
- **å¯¦éš›æ‡‰ç”¨åƒ¹å€¼**ï¼š
  - è§£æ±ºåå†Šè³‡æ–™åŒ…å«æ··åˆæ‘é‡Œåœ°å€çš„å¯¦éš›éœ€æ±‚
  - æä¾›å½ˆæ€§çš„è™•ç†æ¨¡å¼æ»¿è¶³ä¸åŒæ™®æŸ¥å ´æ™¯
  - ä¿æŒè³‡æ–™å®Œæ•´æ€§ï¼šæ‰€æœ‰åœ°å€éƒ½èƒ½å¾—åˆ°é©ç•¶è™•ç†å’Œåˆ†é¡

### Changed

#### ğŸ”’ VillageProcessor ç²¾ç¢ºåŒ¹é…æ”¹é€²
- **ç¦ç”¨æ¨¡ç³ŠåŒ¹é…** (`src/survey_grouping/processors/village_processor.py`)ï¼š
  - ç§»é™¤ `query_address_coordinates()` æ–¹æ³•ä¸­çš„æ¨¡ç³ŠåŒ¹é…é‚è¼¯
  - åƒ…ä½¿ç”¨ç²¾ç¢ºåŒ¹é…é¿å…éŒ¯èª¤çš„åœ°å€é…å°ï¼ˆå¦‚ é ‚å±±2è™Ÿä¹‹3 èª¤é…åˆ° é ‚å±±23è™Ÿï¼‰
  - æ‰¾ä¸åˆ°åŒ¹é…çš„åœ°å€ç›´æ¥è¿”å› Noneï¼Œä¸é€²è¡Œæ¨¡ç³Šæœå°‹
  - æ‰€æœ‰åœ°å€ï¼ˆåŒ…å«æœªåŒ¹é…ï¼‰éƒ½æœƒåŠ å…¥æœ€çµ‚ CSV è¼¸å‡ºï¼Œåº§æ¨™ç•™ç©ºç‚º None
  - æ–°å¢å®Œæ•´çš„æ¸¬è©¦è¦†è“‹ï¼ŒåŒ…å«ç²¾ç¢ºåŒ¹é…é©—è­‰å’Œæ¨¡ç³ŠåŒ¹é…ç¦ç”¨æ¸¬è©¦

#### ğŸ¨ è¦–è¦ºåŒ–é‚è¼¯å„ªåŒ–
- **FoliumRenderer æ”¹é€²** (`src/survey_grouping/visualizers/folium_renderer.py`)ï¼š
  - `_add_route_line()` æ–¹æ³•ï¼šåªåœ¨æœ‰è·¯ç·šé †åºæ™‚ç¹ªè£½é€£ç·š
  - `_add_detailed_route()` æ–¹æ³•ï¼šåªåœ¨æœ‰è·¯ç·šé †åºæ™‚é¡¯ç¤ºè©³ç´°è·¯ç·šå’Œç®­é ­
  - `_add_ordered_markers()` æ–¹æ³•ï¼šæ™ºæ…§åˆ‡æ›æœ‰åº/ç„¡åºæ¨™è¨˜é¡¯ç¤º
  - æ–°å¢ `_add_group_markers_to_map()` æ–¹æ³•ï¼šè™•ç†ç„¡é †åºçš„ä¸€èˆ¬æ¨™è¨˜

#### ğŸ“‹ å‘½ä»¤åˆ—ä»‹é¢æ“´å……
- **main.py æ›´æ–°**ï¼š
  - æ–°å¢ `visualize-from-csv` å‘½ä»¤åŠå…¶åƒæ•¸é¸é …
  - ä¿®æ”¹ `create-groups` å‘½ä»¤æ”¯æ´ `--input-csv` åƒæ•¸ ğŸ†•
  - åƒæ•¸èª¿æ•´ï¼š`district` å’Œ `village` æ”¹ç‚ºå¯é¸åƒæ•¸ï¼Œæ”¯æ´ CSV è¼¸å…¥æ¨¡å¼
  - æ•´åˆ CSVImporter åˆ°ä¸»è¦ CLI ä»‹é¢
  - æ”¹é€²éŒ¯èª¤è™•ç†å’Œä½¿ç”¨è€…æç¤ºè¨Šæ¯

#### ğŸ§ª å…¨é¢æ¸¬è©¦è¦†è“‹ âœ…
- **æ–°å¢ TestUtilityFunctions æ¸¬è©¦é¡åˆ¥** (`tests/test_village_processor.py`)ï¼š
  - `test_convert_fullwidth_to_halfwidth()`ï¼šæ¸¬è©¦å…¨å½¢æ•¸å­—è½‰æ›åŠŸèƒ½
  - `test_extract_neighborhood_from_address()`ï¼šæ¸¬è©¦é„°åˆ¥æå–åŠŸèƒ½
- **æ–°å¢ TestRosterFormatProcessing æ¸¬è©¦é¡åˆ¥** (`tests/test_village_processor.py`)ï¼š
  - `test_roster_format_detection()`ï¼šæ¸¬è©¦åå†Šæ ¼å¼è‡ªå‹•åµæ¸¬
  - `test_roster_format_with_fullwidth_numbers()`ï¼šæ¸¬è©¦å…¨å½¢æ•¸å­—è™•ç†
  - `test_roster_format_cross_district_filtering()`ï¼šæ¸¬è©¦è·¨å€åŸŸåœ°å€éæ¿¾
  - `test_standardize_roster_address_dash_to_zhi_conversion()`ï¼š**é—œéµæ¸¬è©¦** - é©—è­‰ dash-to-zhi è½‰æ›ä¿®å¾©
  - `test_export_invalid_addresses_report()`ï¼šæ¸¬è©¦ç„¡æ•ˆåœ°å€å ±å‘Šç”Ÿæˆ
  - `test_roster_format_comprehensive_workflow()`ï¼šå®Œæ•´å·¥ä½œæµç¨‹æ¸¬è©¦
- **æ–°å¢ TestCrossVillageProcessing æ¸¬è©¦é¡åˆ¥** (`tests/test_village_processor.py`) ğŸ†•ï¼š
  - `test_cross_village_parameter_initialization()`ï¼šæ¸¬è©¦ include_cross_village åƒæ•¸åˆå§‹åŒ–
  - `test_cross_village_address_detection_enabled()`ï¼šæ¸¬è©¦è·¨æ‘é‡Œåœ°å€åµæ¸¬ï¼ˆå•Ÿç”¨æ¨¡å¼ï¼‰
  - `test_cross_village_address_detection_disabled()`ï¼šæ¸¬è©¦è·¨æ‘é‡Œåœ°å€åµæ¸¬ï¼ˆé è¨­æ¨¡å¼ï¼‰
  - `test_standardize_cross_village_address()`ï¼šæ¸¬è©¦è·¨æ‘é‡Œåœ°å€æ¨™æº–åŒ–é‚è¼¯
  - `test_extract_village_name()`ï¼šæ¸¬è©¦æ‘é‡Œåç¨±æå–åŠŸèƒ½
  - `test_query_address_coordinates_with_target_village()`ï¼šæ¸¬è©¦æŒ‡å®šæ‘é‡Œåº§æ¨™æŸ¥è©¢
  - `test_process_data_with_cross_village_enabled()`ï¼šæ¸¬è©¦è·¨æ‘é‡Œå®Œæ•´è³‡æ–™è™•ç†æµç¨‹
  - `test_export_cross_village_addresses()`ï¼šæ¸¬è©¦è·¨æ‘é‡Œåœ°å€ CSV å°å‡º
  - `test_roster_format_with_variable_columns()`ï¼šæ¸¬è©¦ä¸åŒæ¬„ä½æ•¸é‡çš„åå†Šæ ¼å¼è™•ç†
  - `test_comprehensive_cross_village_workflow()`ï¼šç¶œåˆè·¨æ‘é‡Œå·¥ä½œæµç¨‹æ¸¬è©¦
- **æ¸¬è©¦çµæœ**ï¼š29 å€‹æ¸¬è©¦å…¨éƒ¨é€šéï¼ˆæ–°å¢ 11 å€‹è·¨æ‘é‡ŒåŠŸèƒ½æ¸¬è©¦ï¼‰ï¼Œç¢ºä¿æ–°åŠŸèƒ½ç©©å®šæ€§èˆ‡å‘å¾Œç›¸å®¹æ€§

### Technical Details

#### ğŸ—ï¸ æ¶æ§‹æ”¹é€²
- **æ–°å¢ importers æ¨¡çµ„**ï¼šå°ˆé–€è™•ç†å„ç¨®æ ¼å¼çš„è³‡æ–™å°å…¥
- **è³‡æ–™æµç¨‹å„ªåŒ–**ï¼šCSV â†’ CSVGroupRow â†’ RouteGroup â†’ è¦–è¦ºåŒ–
- **éŒ¯èª¤è™•ç†å¼·åŒ–**ï¼šå¾æª”æ¡ˆè®€å–åˆ°è¦–è¦ºåŒ–ç”Ÿæˆçš„å®Œæ•´éŒ¯èª¤è™•ç†éˆ

#### ğŸ§ª ç›¸å®¹æ€§
- **å‘å¾Œç›¸å®¹**ï¼šæ—¢æœ‰çš„ `visualize` å‘½ä»¤åŠŸèƒ½å®Œå…¨ä¸å—å½±éŸ¿
- **ç·¨ç¢¼æ”¯æ´**ï¼šæ”¯æ´ UTF-8 å’Œ UTF-8 BOM ç·¨ç¢¼çš„ CSV æª”æ¡ˆ
- **Python ç‰ˆæœ¬**ï¼šç¶­æŒ Python 3.11+ éœ€æ±‚

### Use Cases

#### ğŸ¯ æ‡‰ç”¨å ´æ™¯æ“´å……
1. **CSV è¼¸å…¥åˆ†çµ„å·¥ä½œæµ** ğŸ†•ï¼š
   ```bash
   # å¾ CSV æª”æ¡ˆç›´æ¥é€²è¡Œåˆ†çµ„
   uv run survey-grouping create-groups --input-csv data/addresses.csv --output-file result.csv
   
   # è‡ªè¨‚åˆ†çµ„å¤§å°
   uv run survey-grouping create-groups --input-csv data/addresses.csv --target-size 30
   
   # è¼¸å‡ºä¸åŒæ ¼å¼
   uv run survey-grouping create-groups --input-csv addresses.csv --output-format excel
   ```

2. **åˆ†çµ„å¾®èª¿å·¥ä½œæµ**ï¼š
   ```bash
   # 1. ç”Ÿæˆåˆå§‹åˆ†çµ„
   uv run survey-grouping create-groups ä¸ƒè‚¡å€ è¥¿å¯®é‡Œ --output-format csv
   
   # 2. æ‰‹å‹•èª¿æ•´ CSV æª”æ¡ˆä¸­çš„åˆ†çµ„åˆ†é…
   
   # 3. é‡æ–°ç”Ÿæˆè¦–è¦ºåŒ–
   uv run survey-grouping visualize-from-csv output/èª¿æ•´å¾Œçš„åˆ†çµ„.csv
   ```

3. **ç„¡è³‡æ–™åº«ç’°å¢ƒä½¿ç”¨** ğŸ†•ï¼š
   ```bash
   # é©åˆå°å‹å°ˆæ¡ˆæˆ–å¿«é€ŸåŸå‹é–‹ç™¼
   uv run survey-grouping create-groups --input-csv simple_addresses.csv
   ```

5. **VillageProcessor Excel è™•ç†å·¥ä½œæµ** ğŸ†•ï¼š
   ```bash
   # è™•ç†é ‚å±±é‡Œ Excel æ•¸æ“š
   uv run python src/survey_grouping/processors/village_processor.py \
     --district ä¸ƒè‚¡å€ --village é ‚å±±é‡Œ \
     --excel-path data/é ‚å±±é‡Œ200æˆ¶.xlsx
   
   # è™•ç†é¹½æ°´å€å¤šå€‹æ‘é‡Œï¼ˆå–®å·¥ä½œè¡¨æ ¼å¼ï¼‰
   uv run python src/survey_grouping/processors/village_processor.py \
     --district é¹½æ°´å€ --village æ–‡æ˜Œé‡Œ \
     --excel-path data/é¹½æ°´å€.xlsx
   
   # è™•ç†ä¸ƒè‚¡é‡Œåå†Šæ ¼å¼
   uv run python src/survey_grouping/processors/village_processor.py \
     --district ä¸ƒè‚¡å€ --village ä¸ƒè‚¡é‡Œ \
     --excel-path data/ä¸ƒè‚¡é‡Œ.xlsx
   
   # ğŸ†• è·¨æ‘é‡Œè™•ç†æ¨¡å¼ï¼ˆè™•ç†åŒå€å…¶ä»–æ‘é‡Œåœ°å€ï¼‰
   uv run python src/survey_grouping/processors/village_processor.py \
     --district ä¸ƒè‚¡å€ --village ä¸ƒè‚¡é‡Œ \
     --excel-path data/ä¸ƒè‚¡é‡Œ.xlsx \
     --include-cross-village
   
   # æª¢æŸ¥è™•ç†çµæœå’ŒåŒ¹é…ç‡
   # åŒ¹é…ç‡å¾åŸæœ¬çš„ 90.6% æå‡è‡³ 96.9%ï¼ˆdash-to-zhi ä¿®å¾©å¾Œï¼‰
   # è·¨æ‘é‡Œæ¨¡å¼é¡å¤–æä¾›å¡©åŸ•é‡Œç­‰å…¶ä»–æ‘é‡Œåœ°å€çš„åº§æ¨™åŒ¹é…
   ```

4. **æ‰¹æ¬¡è¦–è¦ºåŒ–è™•ç†**ï¼š
   ```bash
   # ç‚ºå¤šå€‹é å…ˆæº–å‚™çš„ CSV æª”æ¡ˆç”Ÿæˆåœ°åœ–
   for file in *.csv; do
     uv run survey-grouping visualize-from-csv "$file" --output-dir "maps_$(basename "$file" .csv)"
   done
   ```

---

## [Previous Versions]

### [0.2.0] - 2024-xx-xx
- feat(visualization): implement interactive map visualization with Folium
- test(coverage): improve test coverage from 55% to 63%
- chore(gitignore): add map visualization output directories to gitignore

### [0.1.0] - 2024-xx-xx
- Initial release with basic grouping functionality
- PostGIS spatial database integration
- CLI interface with Typer
- Multiple export formats support